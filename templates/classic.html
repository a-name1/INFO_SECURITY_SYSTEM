<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»å…¸å¯†ç ç®—æ³• - ä¿¡æ¯å®‰å…¨æŠ€æœ¯ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="brand">ä¿¡æ¯å®‰å…¨æŠ€æœ¯ç³»ç»Ÿ</div>
            <div class="nav-right">
                <a href="{{ url_for('index') }}">é¦–é¡µ</a>
                <a href="{{ url_for('help_page') }}">ğŸ“š å¸®åŠ©</a>
                <button id="logout-btn">ç™»å‡º</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1>ç»å…¸å¯†ç ç®—æ³•</h1>

        <div class="tabs">
            <button class="tab-btn active" data-tab="caesar">å‡¯æ’’å¯†ç </button>
            <button class="tab-btn" data-tab="substitution">å•è¡¨ç½®æ¢</button>
            <button class="tab-btn" data-tab="playfair">Playfair</button>
        </div>

        <!-- å‡¯æ’’å¯†ç  -->
        <div id="caesar" class="tab-content active">
            <h2>å‡¯æ’’å¯†ç </h2>
            <div class="info-box">
                <h4>ğŸ“– ç®—æ³•ä»‹ç»</h4>
                <p><strong>åŸç†ï¼š</strong>å°†æ˜æ–‡ä¸­çš„æ¯ä¸ªå­—æ¯æŒ‰ç…§å­—æ¯è¡¨é¡ºåºå‘åç§»åŠ¨å›ºå®šæ•°é‡çš„ä½ç½®</p>
                <p><strong>åŠ å¯†ï¼š</strong> A + ä½ç§»æ•° = å¯†æ–‡å­—æ¯</p>
                <p><strong>è§£å¯†ï¼š</strong> å¯†æ–‡ - ä½ç§»æ•° = æ˜æ–‡å­—æ¯</p>
                <p><strong>ç‰¹ç‚¹ï¼š</strong>ç®€å•æ˜“æ‡‚ï¼Œä½†å®‰å…¨æ€§ä½ï¼Œåªæœ‰26ç§å¯èƒ½</p>
                <p><strong>åº”ç”¨ï¼š</strong>æ•™å­¦æ¼”ç¤ºã€ç®€å•æ•°æ®æ··æ·†</p>
            </div>
            <div class="form-group">
                <label for="caesar-text">æ–‡æœ¬</label>
                <textarea id="caesar-text" placeholder="è¾“å…¥è¦åŠ å¯†/è§£å¯†çš„æ–‡æœ¬" rows="4"></textarea>
                <p style="font-size: 12px; color: #666; margin: 5px 0;">ğŸ“Š è¾“å…¥é™åˆ¶ï¼šæœ€å¤š 10000 å­—ç¬¦</p>
            </div>
            <div class="form-group">
                <label for="caesar-shift">ä½ç§»é‡</label>
                <input type="number" id="caesar-shift" value="3" min="1" max="25">
                <p style="font-size: 12px; color: #666; margin: 5px 0;">ğŸ’¡ æç¤ºï¼šä½ç§»é‡èŒƒå›´1-25ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åçš„ä½ç§» (åŠ 3 = è§£-3)</p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="caesarEncrypt()">åŠ å¯†</button>
                <button class="btn btn-primary" onclick="caesarDecrypt()">è§£å¯†</button>
            </div>
            <div id="caesar-result" class="result"></div>
        </div>

        <!-- å•è¡¨ç½®æ¢ -->
        <div id="substitution" class="tab-content">
            <h2>å•è¡¨ç½®æ¢å¯†ç </h2>
            <div class="info-box">
                <h4>ğŸ“– ç®—æ³•ä»‹ç»</h4>
                <p><strong>åŸç†ï¼š</strong>ä½¿ç”¨ä¸€ä¸ª26å­—æ¯çš„æ›¿æ¢è¡¨ï¼Œæ¯ä¸ªå­—æ¯å¯¹åº”æ›¿æ¢è¡¨ä¸­çš„ä¸€ä¸ªå­—æ¯</p>
                <p><strong>åŠ å¯†ï¼š</strong>æŒ‰ç…§æ›¿æ¢è¡¨æ›¿æ¢æ¯ä¸ªå­—æ¯ï¼ˆä¿æŒå¤§å°å†™ï¼‰</p>
                <p><strong>è§£å¯†ï¼š</strong>ä½¿ç”¨é€†å‘æ›¿æ¢è¡¨æ¢å¤åŸæ–‡</p>
                <p><strong>ç‰¹ç‚¹ï¼š</strong>å¯†é’¥ç©ºé—´å¤§ï¼ˆ26!ç§å¯èƒ½ï¼‰ï¼Œæ¯”å‡¯æ’’å¯†ç å®‰å…¨</p>
                <p><strong>ä½¿ç”¨ï¼š</strong>è¾“å…¥æ–‡æœ¬ï¼Œè‡ªåŠ¨ç”Ÿæˆæˆ–è¾“å…¥å¯†é’¥ï¼Œç‚¹å‡»åŠ /è§£å¯†</p>
                <p><strong>æç¤ºï¼š</strong>å¯†é’¥å¿…é¡»åŒ…å«26ä¸ªä¸åŒçš„å­—æ¯</p>
            </div>
            <div class="form-group">
                <label for="substitution-text">æ–‡æœ¬</label>
                <textarea id="substitution-text" placeholder="è¾“å…¥è¦åŠ å¯†/è§£å¯†çš„æ–‡æœ¬"></textarea>
            </div>
            <div class="form-group">
                <label for="substitution-key">æ›¿æ¢è¡¨ï¼ˆ26ä¸ªå­—æ¯ï¼‰</label>
                <textarea id="substitution-key" placeholder="è¾“å…¥æ›¿æ¢è¡¨ï¼Œæˆ–ç‚¹å‡»æŒ‰é’®è‡ªåŠ¨ç”Ÿæˆ" rows="3"></textarea>
                <p style="font-size: 12px; color: #666; margin: 5px 0;">ğŸ’¡ æç¤ºï¼šå¯†é’¥å¿…é¡»åŒ…å«26ä¸ªä¸åŒçš„å­—æ¯A-Zï¼ˆä¸åˆ†å¤§å°å†™ï¼‰| ğŸ“Š è¾“å…¥é™åˆ¶ï¼šæœ€å¤š 10000 å­—ç¬¦</p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="substitutionEncrypt()">åŠ å¯†</button>
                <button class="btn btn-primary" onclick="substitutionDecrypt()">è§£å¯†</button>
                <button class="btn btn-secondary" onclick="generateSubstitutionKey()">ğŸ”‘ ç”Ÿæˆå¯†é’¥</button>
            </div>
            <div id="substitution-result" class="result"></div>
        </div>

        <!-- Playfair -->
        <div id="playfair" class="tab-content">
            <h2>Playfairå¯†ç </h2>
            <div class="info-box">
                <h4>ğŸ“– ç®—æ³•ä»‹ç»</h4>
                <p><strong>åŸç†ï¼š</strong>åŸºäº5Ã—5çš„å­—æ¯çŸ©é˜µï¼Œå¯¹ä¸¤ä¸ªå­—æ¯çš„å¯¹è¿›è¡ŒåŠ å¯†</p>
                <p><strong>çŸ©é˜µæ„å»ºï¼š</strong>æ ¹æ®å¯†é’¥æ„å»º5Ã—5çŸ©é˜µï¼ˆIå’ŒJå…±ç”¨ä¸€ä¸ªä½ç½®ï¼‰</p>
                <p><strong>åŠ å¯†è§„åˆ™ï¼š</strong></p>
                <ul style="margin: 5px 0 5px 20px;">
                    <li>åŒè¡Œï¼šå‘å³å¾ªç¯ç§»åŠ¨</li>
                    <li>åŒåˆ—ï¼šå‘ä¸‹å¾ªç¯ç§»åŠ¨</li>
                    <li>çŸ©å½¢ï¼šäº¤æ¢åˆ—åæ ‡</li>
                </ul>
                <p><strong>ç‰¹ç‚¹ï¼š</strong>æ¯”æ›¿æ¢å¯†ç æ›´å¤æ‚ï¼Œç ´è¯‘éš¾åº¦æ›´é«˜</p>
                <p><strong>ä½¿ç”¨ï¼š</strong>è¾“å…¥æ–‡æœ¬å’Œå¯†é’¥ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†å­—æ¯å¯¹é½å’ŒåŠ å¯†</p>
            </div>
            <div class="form-group">
                <label for="playfair-text">æ–‡æœ¬</label>
                <textarea id="playfair-text" placeholder="è¾“å…¥è¦åŠ å¯†/è§£å¯†çš„æ–‡æœ¬"></textarea>
            </div>
            <div class="form-group">
                <label for="playfair-key">å¯†é’¥ï¼ˆç”¨äºæ„å»º5Ã—5çŸ©é˜µï¼‰</label>
                <input type="text" id="playfair-key" placeholder="è¾“å…¥æˆ–ç”Ÿæˆå¯†é’¥">
                <p style="font-size: 12px; color: #666; margin: 5px 0;">ğŸ’¡ æç¤ºï¼šå¯†é’¥å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†I/Jåˆå¹¶å’ŒçŸ©é˜µæ„å»º | ğŸ“Š è¾“å…¥é™åˆ¶ï¼šæœ€å¤š 100 å­—ç¬¦</p>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="playfairEncrypt()">åŠ å¯†</button>
                <button class="btn btn-primary" onclick="playfairDecrypt()">è§£å¯†</button>
                <button class="btn btn-secondary" onclick="generatePlayfairKey()">ğŸ”‘ ç”Ÿæˆå¯†é’¥</button>
            </div>
            <div id="playfair-result" class="result"></div>
        </div>
    </div>

    <script>
        // æ ‡ç­¾é¡µåˆ‡æ¢
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.getElementById(tabName).classList.add('active');
                this.classList.add('active');
            });
        });

        // ç™»å‡º
        document.getElementById('logout-btn').addEventListener('click', function() {
            fetch('/auth/logout', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = '/';
                    }
                });
        });

        // å‡¯æ’’å¯†ç 
        async function caesarEncrypt() {
            const text = document.getElementById('caesar-text').value;
            const shift = document.getElementById('caesar-shift').value;
            
            if (!text) {
                alert('è¯·è¾“å…¥æ–‡æœ¬');
                return;
            }
            
            try {
                const response = await fetch('/api/classic/caesar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, shift, operation: 'encrypt' })
                });
                
                const data = await response.json();
                if (data.success) {
                    document.getElementById('caesar-result').innerHTML = 
                        `<h3>åŠ å¯†ç»“æœ</h3><p>${data.result}</p>`;
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('åŠ å¯†å¤±è´¥: ' + error.message);
            }
        }

        function caesarDecrypt() {
            const text = document.getElementById('caesar-text').value;
            const shift = document.getElementById('caesar-shift').value;
            
            if (!text) {
                alert('è¯·è¾“å…¥æ–‡æœ¬');
                return;
            }
            
            fetch('/api/classic/caesar', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, shift, operation: 'decrypt' })
            })
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('caesar-result').innerHTML = 
                        `<h3>è§£å¯†ç»“æœ</h3><p>${data.result}</p>`;
                } else {
                    alert(data.message);
                }
            });
        }

        // å•è¡¨ç½®æ¢
        async function substitutionEncrypt() {
            const text = document.getElementById('substitution-text').value;
            const key = document.getElementById('substitution-key').value;
            
            if (!text) {
                alert('è¯·è¾“å…¥æ–‡æœ¬');
                return;
            }
            
            try {
                const response = await fetch('/api/classic/substitution', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, key: key || null, operation: 'encrypt' })
                });
                
                const data = await response.json();
                if (data.success) {
                    document.getElementById('substitution-key').value = data.key;
                    document.getElementById('substitution-result').innerHTML = 
                        `<h3>åŠ å¯†ç»“æœ</h3><p>${data.result}</p>`;
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('åŠ å¯†å¤±è´¥: ' + error.message);
            }
        }

        function substitutionDecrypt() {
            const text = document.getElementById('substitution-text').value;
            const key = document.getElementById('substitution-key').value;
            
            if (!text || !key) {
                alert('è¯·è¾“å…¥æ–‡æœ¬å’Œå¯†é’¥');
                return;
            }
            
            fetch('/api/classic/substitution', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, key, operation: 'decrypt' })
            })
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('substitution-result').innerHTML = 
                        `<h3>è§£å¯†ç»“æœ</h3><p>${data.result}</p>`;
                } else {
                    alert(data.message);
                }
            });
        }

        function generateSubstitutionKey() {
            const alphabet = 'abcdefghijklmnopqrstuvwxyz';
            const arr = alphabet.split('');
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            document.getElementById('substitution-key').value = arr.join('');
            alert('âœ… å•è¡¨ç½®æ¢å¯†é’¥å·²ç”Ÿæˆï¼');
        }

        // Playfairå¯†é’¥ç”Ÿæˆ
        function generatePlayfairKey() {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            let key = '';
            for (let i = 0; i < 8; i++) {
                key += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('playfair-key').value = key;
            alert('âœ… Playfairå¯†é’¥å·²ç”Ÿæˆï¼');
        }

        // Playfair
        async function playfairEncrypt() {
            const text = document.getElementById('playfair-text').value;
            const key = document.getElementById('playfair-key').value;
            
            if (!text || !key) {
                alert('è¯·è¾“å…¥æ–‡æœ¬å’Œå¯†é’¥');
                return;
            }
            
            try {
                const response = await fetch('/api/classic/playfair', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, key, operation: 'encrypt' })
                });
                
                const data = await response.json();
                if (data.success) {
                    document.getElementById('playfair-result').innerHTML = 
                        `<h3>åŠ å¯†ç»“æœ</h3><p>${data.result}</p>`;
                } else {
                    alert(data.message);
                }
            } catch (error) {
                alert('åŠ å¯†å¤±è´¥: ' + error.message);
            }
        }

        function playfairDecrypt() {
            const text = document.getElementById('playfair-text').value;
            const key = document.getElementById('playfair-key').value;
            
            if (!text || !key) {
                alert('è¯·è¾“å…¥æ–‡æœ¬å’Œå¯†é’¥');
                return;
            }
            
            fetch('/api/classic/playfair', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, key, operation: 'decrypt' })
            })
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('playfair-result').innerHTML = 
                        `<h3>è§£å¯†ç»“æœ</h3><p>${data.result}</p>`;
                } else {
                    alert(data.message);
                }
            });
        }
    </script>
</body>
</html>
